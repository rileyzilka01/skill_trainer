import matplotlib.pyplot as plt
import numpy as np

def softmax(values):
    exp_values = np.exp(values - np.max(values))  # Subtract max for numerical stability
    return exp_values / np.sum(exp_values)

def plot_drawing(data, output_file="drawing_plot.png"):

    x_prev, y_prev = None, None  
    plt.figure(figsize=(6, 6))
    plt.axis([0, 255, 0, 255])
    plt.gca().invert_yaxis() 

    for point in data:
        x, y, on_paper = point

        softmax_values = softmax([on_paper])
        print(on_paper)
        # on_paper_prob = softmax_values[0]
        # termination_prob = softmax_values[1]

        if on_paper == 1: 
            if x_prev is not None and y_prev is not None:
                plt.plot([x_prev, x], [y_prev, y], color="black")  # Draw a line

        # if termination < 0.0:
        #     break

        x_prev, y_prev = x, y


    plt.title("Generated Doodle")
    plt.xlabel("X")
    plt.ylabel("Y")
    plt.grid(True)

    # Save the figure to a file
    plt.savefig(output_file, dpi=300, bbox_inches='tight')
    print(f"Plot saved as {output_file}")
    plt.close() 



data = [[79.00947570800781, 8.814371109008789, -1.05959153175354], [89.56844329833984, 65.57938385009766, 1.0524698495864868], [114.23274230957031, 154.17625427246094, 1.369571566581726], [28.811153411865234, 33.58857727050781, -0.3650406301021576], [2.933845281600952, 2.9751718044281006, -1.0877326726913452], [0.5533110499382019, 3.5508103370666504, -1.0124510526657104], [3.0702426433563232, 1.7627936601638794, -0.9592525959014893], [0.1302797943353653, -1.6663017272949219, -0.9904987215995789], [-0.7222043871879578, 1.2133584022521973, -0.9891297221183777], [3.888049840927124, 1.1125954389572144, -0.9906104207038879], [2.7196431159973145, -0.3780492842197418, -0.9921678900718689], [1.713639497756958, 1.408090353012085, -0.9752612709999084], [1.6589604616165161, 3.355478048324585, -0.9652509093284607], [3.3215839862823486, 2.510053873062134, -0.980259895324707], [2.910271167755127, 3.0456960201263428, -0.9693673849105835], [2.264465570449829, 2.3414342403411865, -0.9752321243286133], [1.705773949623108, 1.69535493850708, -0.9776802659034729], [1.7556729316711426, 2.190734386444092, -0.9820370674133301], [1.6078760623931885, 0.7267717719078064, -0.9841242432594299], [2.0268263816833496, 1.984648585319519, -0.9794806241989136], [1.247229814529419, 2.059664249420166, -0.9826239347457886], [0.6460185050964355, 2.2794899940490723, -0.9755218029022217], [1.7689570188522339, 2.3725697994232178, -0.982417643070221], [2.5259523391723633, 2.5963776111602783, -0.9871437549591064], [1.4905383586883545, 1.6174135208129883, -0.9878784418106079], [1.9910626411437988, 2.1289117336273193, -0.9802861213684082], [0.2903119921684265, 1.99876868724823, -0.9911016821861267], [1.5775384902954102, 3.2829325199127197, -0.9821327924728394], [0.3148662745952606, 2.580578088760376, -0.9944917559623718], [2.4782421588897705, 3.0062692165374756, -0.9811519980430603], [0.9518640637397766, 2.2354578971862793, -0.9932129979133606], [2.7866790294647217, 2.043241500854492, -0.9845709800720215], [2.362006425857544, 1.1298160552978516, -0.9991932511329651], [1.775667428970337, 2.3669991493225098, -0.996393084526062], [1.1795098781585693, 1.125423550605774, -0.9674932360649109], [3.976144313812256, 1.5750077962875366, -0.986011803150177], [3.1572048664093018, 2.818620204925537, -0.9767068028450012], [3.6674184799194336, 0.7827731370925903, -1.0105174779891968], [2.894486904144287, 0.9809249043464661, -1.0054153203964233], [1.6644245386123657, 1.9963747262954712, -1.0081231594085693], [-0.7398962378501892, -1.0018998384475708, -1.0044596195220947], [2.765711784362793, 3.8727519512176514, -0.9810529351234436], [-0.8896690011024475, 0.08780568093061447, -0.9882481694221497], [5.556236267089844, 0.4233732521533966, -0.9902290105819702], [-0.13176171481609344, 4.329031467437744, -0.9924590587615967], [3.3868417739868164, 3.0693154335021973, -1.0118060111999512], [1.3127306699752808, 3.20918607711792, -0.9972759485244751], [-0.442448228597641, 2.8267364501953125, -1.0046496391296387], [0.3730943500995636, 1.0517834424972534, -0.994524359703064], [1.466903567314148, 2.1386163234710693, -0.9973498582839966], [-1.339124083518982, 0.5314926505088806, -0.9892041683197021], [4.0018157958984375, 3.8418824672698975, -0.9821705222129822], [1.278631329536438, -0.3175261318683624, -0.9713045358657837], [2.475209951400757, 2.435243606567383, -0.9993501305580139], [3.3576440811157227, 3.1803910732269287, -0.9862619638442993], [2.136594772338867, 2.377441167831421, -0.9927400946617126], [-2.2991957664489746, 1.7974250316619873, -0.9760675430297852], [2.8654792308807373, 3.2236328125, -0.9866474866867065], [1.0333316326141357, 1.5748862028121948, -0.9858734607696533], [2.33085560798645, 2.5110647678375244, -0.9697940349578857], [2.726931095123291, 2.8049638271331787, -0.9659448266029358], [3.1262364387512207, 0.42107057571411133, -0.9774090051651001], [7.105565071105957, -0.0884440466761589, -0.9672877788543701], [3.26190447807312, 1.187808632850647, -0.9923024773597717]]

plot_drawing(data, output_file="eval/drawings/drawing_output.png")